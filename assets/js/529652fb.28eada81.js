"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3129],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),h=c(n),m=a,u=h["".concat(l,".").concat(m)]||h[m]||d[m]||i;return n?r.createElement(u,o(o({ref:t},p),{},{components:n})):r.createElement(u,o({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},2916:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var r=n(7462),a=(n(7294),n(3905));const i={id:"\u5bf9threejs\u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5",sidebar_position:1,title:"\u5bf9threejs\u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5",data:"2023\u5e745\u670822\u65e5"},o=void 0,s={unversionedId:"\u5bf9threejs\u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5",id:"\u5bf9threejs\u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5",title:"\u5bf9threejs\u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5",description:"\u524d\u8a00",source:"@site/web/ThreeJs/\u5bf9threejs\u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5.md",sourceDirName:".",slug:"/\u5bf9threejs\u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5",permalink:"/ThreeJs/\u5bf9threejs\u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/web/ThreeJs/\u5bf9threejs\u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5.md",tags:[],version:"current",lastUpdatedBy:"fenghang",lastUpdatedAt:1684742025,formattedLastUpdatedAt:"May 22, 2023",sidebarPosition:1,frontMatter:{id:"\u5bf9threejs\u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5",sidebar_position:1,title:"\u5bf9threejs\u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5",data:"2023\u5e745\u670822\u65e5"},sidebar:"tutorialSidebar",previous:{title:"ThreeJs",permalink:"/ThreeJs/"}},l={},c=[{value:"\u524d\u8a00",id:"\u524d\u8a00",level:2},{value:"\u57fa\u7840\u529f\u80fd",id:"\u57fa\u7840\u529f\u80fd",level:2},{value:"1.\u573a\u666f Viewer \u7c7b",id:"1\u573a\u666f-viewer-\u7c7b",level:2},{value:"1.1 \u521d\u59cb\u5316\u573a\u666f\u548c\u6444\u50cf\u673a",id:"11-\u521d\u59cb\u5316\u573a\u666f\u548c\u6444\u50cf\u673a",level:3},{value:"1.2 \u521d\u59cb\u5316\u6444\u50cf\u673a\u63a7\u5236\u5668",id:"12-\u521d\u59cb\u5316\u6444\u50cf\u673a\u63a7\u5236\u5668",level:3},{value:"1.3 \u521d\u59cb\u5316\u706f\u5149",id:"13-\u521d\u59cb\u5316\u706f\u5149",level:3},{value:"1.4 \u521d\u59cb\u5316\u6e32\u67d3\u5668",id:"14-\u521d\u59cb\u5316\u6e32\u67d3\u5668",level:3},{value:"1.5 \u9f20\u6807\u4e8b\u4ef6",id:"15-\u9f20\u6807\u4e8b\u4ef6",level:3},{value:"2.\u6a21\u578b\u52a0\u8f7d\u5668 ModelLoder \u7c7b",id:"2\u6a21\u578b\u52a0\u8f7d\u5668-modelloder-\u7c7b",level:2},{value:"3.\u6a21\u578b BaseModel \u7c7b",id:"3\u6a21\u578b-basemodel-\u7c7b",level:2},{value:"4.\u5929\u7a7a\u76d2 SkyBoxs \u7c7b",id:"4\u5929\u7a7a\u76d2-skyboxs-\u7c7b",level:2},{value:"\u63a8\u8350\u9879\u76ee",id:"\u63a8\u8350\u9879\u76ee",level:2}],p={toc:c};function d(e){let{components:t,...i}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"\u524d\u8a00"},"\u524d\u8a00"),(0,a.kt)("p",null,"\u672c\u6587\u9700\u8981\u5bf9 threejs \u7684\u4e00\u4e9b\u57fa\u672c\u6982\u5ff5\u548c api \u6709\u4e00\u5b9a\u4e86\u89e3\u3002  "),(0,a.kt)("p",null,"\u5982\u679c\u5bf9threejs\u8fd9\u90e8\u5206\u8fd8\u4e0d\u4e86\u89e3\u7684\u53ef\u4ee5\u770b\u4e0b\u5b98\u65b9\u6587\u6863\u548c\u4e00\u4e9b\u4e2d\u6587\u6587\u6863\u8fdb\u884c\u5b66\u4e60\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5b98\u65b9\u6587\u6863\u5730\u5740\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://threejs.org/"},"https://threejs.org/")),(0,a.kt)("p",{parentName:"blockquote"},"\u4e2d\u6587\u6587\u6863\u5730\u5740\uff1a",(0,a.kt)("a",{parentName:"p",href:"http://www.webgl3d.cn/pages/aac9ab/"},"http://www.webgl3d.cn/pages/aac9ab/"))),(0,a.kt)("p",null,"\u672c\u6587\u4e3b\u8981\u4e3b\u8981\u8bb2\u8ff0\u5bf9 threejs \u7684\u4e00\u4e9b api \u8fdb\u884c\u57fa\u672c\u7684\u5c01\u88c5\uff0c\u5728 vue3 \u9879\u76ee\u4e2d\u6765\u5b9e\u73b0\u4e00\u4e2a\u53ef\u89c6\u5316\u76843d\u9879\u76ee\u3002\u5305\u542b\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u529f\u80fd\uff0c",(0,a.kt)("strong",{parentName:"p"},"\u573a\u666f\u3001\u706f\u5149\u3001\u6444\u50cf\u673a\u521d\u59cb\u5316\uff0c\u6a21\u578b\u3001\u5929\u7a7a\u76d2\u7684\u52a0\u8f7d\uff0c\u4ee5\u53ca\u9f20\u6807\u70b9\u51fb\u548c\u60ac\u6d6e\u7684\u4e8b\u4ef6\u4ea4\u4e92\u3002")),(0,a.kt)("p",null,"\u9879\u76ee\u622a\u56fe\uff1a"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"\u9879\u76ee\u622a\u56fe",src:n(3280).Z,title:"\u9879\u76ee\u622a\u56fe",width:"500",height:"300"})),(0,a.kt)("p",null,"Github \u5730\u5740\uff1a\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/fh332393900/threejs-demo"},"https://github.com/fh332393900/threejs-demo")),(0,a.kt)("h2",{id:"\u57fa\u7840\u529f\u80fd"},"\u57fa\u7840\u529f\u80fd"),(0,a.kt)("h2",{id:"1\u573a\u666f-viewer-\u7c7b"},"1.\u573a\u666f Viewer \u7c7b"),(0,a.kt)("p",null,"\u9996\u5148\u6211\u4eec\u7b2c\u4e00\u6b65\u9700\u8981\u521d\u59cb\u5316\u573a\u666f\u3001\u6444\u50cf\u673a\u3001\u6e32\u67d3\u5668\u3001\u706f\u5149\u7b49\u3002\u8fd9\u4e9b\u529f\u80fd\u53ea\u9700\u8981\u52a0\u8f7d\u4e00\u6b21\uff0c\u6211\u4eec\u90fd\u653e\u5230 ",(0,a.kt)("strong",{parentName:"p"},"Viewer")," \u7c7b\u4e2d\u53ef\u4ee5\u5206\u79bb\u5173\u6ce8\u70b9\uff0c\u5728\u4e1a\u52a1\u4ee3\u7801\u4e2d\u5c31\u4e0d\u9700\u8981\u5173\u6ce8\u8fd9\u4e00\u90e8\u5206\u903b\u8f91\u3002\u4e1a\u52a1\u4ee3\u7801\u4e2d\u6211\u4eec\u53ea\u9700\u8981\u5173\u6ce8\u6570\u636e\u4e0e\u4ea4\u4e92\u5373\u53ef\u3002"),(0,a.kt)("h3",{id:"11-\u521d\u59cb\u5316\u573a\u666f\u548c\u6444\u50cf\u673a"},"1.1 \u521d\u59cb\u5316\u573a\u666f\u548c\u6444\u50cf\u673a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"private initScene() {\n  this.scene = new Scene();\n}\n\nprivate initCamera() {\n  // \u6e32\u67d3\u76f8\u673a\n  this.camera = new PerspectiveCamera(25, window.innerWidth / window.innerHeight, 1, 2000);\n  //\u8bbe\u7f6e\u76f8\u673a\u4f4d\u7f6e\n  this.camera.position.set(4, 2, -3);\n  //\u8bbe\u7f6e\u76f8\u673a\u65b9\u5411\n  this.camera.lookAt(0, 0, 0);\n}\n")),(0,a.kt)("h3",{id:"12-\u521d\u59cb\u5316\u6444\u50cf\u673a\u63a7\u5236\u5668"},"1.2 \u521d\u59cb\u5316\u6444\u50cf\u673a\u63a7\u5236\u5668"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"private initControl() {\n  this.controls = new OrbitControls(\n    this.camera as Camera,\n    this.renderer?.domElement\n  );\n  this.controls.enableDamping = false;\n  this.controls.screenSpacePanning = false; // \u5b9a\u4e49\u5e73\u79fb\u65f6\u5982\u4f55\u5e73\u79fb\u76f8\u673a\u7684\u4f4d\u7f6e \u63a7\u5236\u4e0d\u4e0a\u4e0b\u79fb\u52a8\n  this.controls.minDistance = 2;\n  this.controls.maxDistance = 1000;\n  this.controls.addEventListener('change', ()=>{\n    this.renderer.render(this.scene, this.camera);\n  });\n}\n")),(0,a.kt)("h3",{id:"13-\u521d\u59cb\u5316\u706f\u5149"},"1.3 \u521d\u59cb\u5316\u706f\u5149"),(0,a.kt)("p",null,"\u8fd9\u91cc\u653e\u4e86\u4e00\u4e2a\u73af\u5883\u706f\u5149\u548c\u5e73\u884c\u706f\u5149\uff0c\u8fd9\u91cc\u662f\u5199\u5728 Viewer \u7c7b\u91cc\u9762\u7684\uff0c\u5982\u679c\u60f3\u7075\u6d3b\u4e00\u70b9\uff0c\u4e5f\u53ef\u4ee5\u62bd\u8c61\u51fa\u53bb\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"private initLight() {\n  const ambient = new AmbientLight(0xffffff, 0.6);\n  this.scene.add(ambient);\n\n  const light = new THREE.DirectionalLight( 0xffffff );\n  light.position.set( 0, 200, 100 );\n  light.castShadow = true;\n\n  light.shadow.camera.top = 180;\n  light.shadow.camera.bottom = -100;\n  light.shadow.camera.left = -120;\n  light.shadow.camera.right = 400;\n  light.shadow.camera.near = 0.1;\n  light.shadow.camera.far = 400;\n  // \u8bbe\u7f6emapSize\u5c5e\u6027\u53ef\u4ee5\u4f7f\u9634\u5f71\u66f4\u6e05\u6670\uff0c\u4e0d\u90a3\u4e48\u6a21\u7cca\n  light.shadow.mapSize.set(1024, 1024);\n\n  this.scene.add(light);\n}\n")),(0,a.kt)("h3",{id:"14-\u521d\u59cb\u5316\u6e32\u67d3\u5668"},"1.4 \u521d\u59cb\u5316\u6e32\u67d3\u5668"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"private initRenderer() {\n  // \u83b7\u53d6\u753b\u5e03dom\n  this.viewerDom = document.getElementById(this.id) as HTMLElement;\n  // \u521d\u59cb\u5316\u6e32\u67d3\u5668\n  this.renderer = new WebGLRenderer({\n    logarithmicDepthBuffer: true,\n    antialias: true, // true/false\u8868\u793a\u662f\u5426\u5f00\u542f\u53cd\u952f\u9f7f\n    alpha: true, // true/false \u8868\u793a\u662f\u5426\u53ef\u4ee5\u8bbe\u7f6e\u80cc\u666f\u8272\u900f\u660e\n    precision: 'mediump', // highp/mediump/lowp \u8868\u793a\u7740\u8272\u7cbe\u5ea6\u9009\u62e9\n    premultipliedAlpha: true, // true/false \u8868\u793a\u662f\u5426\u53ef\u4ee5\u8bbe\u7f6e\u50cf\u7d20\u6df1\u5ea6\uff08\u7528\u6765\u5ea6\u91cf\u56fe\u50cf\u7684\u5206\u8fa8\u7387\uff09\n    // preserveDrawingBuffer: false, // true/false \u8868\u793a\u662f\u5426\u4fdd\u5b58\u7ed8\u56fe\u7f13\u51b2\n    // physicallyCorrectLights: true, // true/false \u8868\u793a\u662f\u5426\u5f00\u542f\u7269\u7406\u5149\u7167\n  });\n  this.renderer.clearDepth();\n\n  this.renderer.shadowMap.enabled = true;\n  this.renderer.outputColorSpace = SRGBColorSpace; // \u53ef\u4ee5\u770b\u5230\u66f4\u4eae\u7684\u6750\u8d28\uff0c\u540c\u65f6\u8fd9\u4e5f\u5f71\u54cd\u5230\u73af\u5883\u8d34\u56fe\u3002\n  this.viewerDom.appendChild(this.renderer.domElement);\n}\n")),(0,a.kt)("p",null,"Viewer \u91cc\u9762\u8fd8\u52a0\u4e86\u4e00\u4e9b addAxis \u6dfb\u52a0\u5750\u6807\u8f74\u3001addStats \u6027\u80fd\u76d1\u63a7\u7b49\u8f85\u52a9\u7684\u516c\u7528\u65b9\u6cd5\u3002\u5177\u4f53\u53ef\u4ee5\u770b\u4ed3\u5e93\u5b8c\u6574\u4ee3\u7801\u3002"),(0,a.kt)("h3",{id:"15-\u9f20\u6807\u4e8b\u4ef6"},"1.5 \u9f20\u6807\u4e8b\u4ef6"),(0,a.kt)("p",null,"\u91cc\u9762\u4e3b\u8981\u4f7f\u7528\u4e86 ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("a",{parentName:"strong",href:"https://github.com/developit/mitt"},"mitt"))," \u8fd9\u4e2a\u5e93\uff0c\u6765\u53d1\u5e03\u8ba2\u9605\u4e8b\u4ef6\u3002"),(0,a.kt)("p",null,"threejs\u91cc\u9762\u7684\u9f20\u6807\u4e8b\u4ef6\u4e3b\u8981\u901a\u8fc7\u628a\u5c4f\u5e55\u5750\u6807\u8f6c\u6362\u6210 3D \u5750\u6807\u3002\u901a\u8fc7",(0,a.kt)("inlineCode",{parentName:"p"},"raycaster.intersectObjects"),"\u65b9\u6cd5\u8f6c\u6362\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"/**\u6ce8\u518c\u9f20\u6807\u4e8b\u4ef6\u76d1\u542c */\npublic initRaycaster() {\n  this.raycaster = new Raycaster();\n\n  const initRaycasterEvent: Function = (eventName: keyof HTMLElementEventMap): void => {\n    const funWrap = throttle(\n      (event: any) => {\n        this.mouseEvent = event;\n        this.mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\n        this.mouse.y = - (event.clientY / window.innerHeight) * 2 + 1;\n        // @ts-expect-error\n        this.emitter.emit(Events[eventName].raycaster, this.getRaycasterIntersectObjects());\n      },\n      50\n    );\n    this.viewerDom.addEventListener(eventName, funWrap, false);\n  };\n\n  // \u521d\u59cb\u5316\u5e38\u7528\u7684\u51e0\u79cd\u9f20\u6807\u4e8b\u4ef6\n  initRaycasterEvent('click');\n  initRaycasterEvent('dblclick');\n  initRaycasterEvent('mousemove');\n}\n\n/**\u81ea\u5b9a\u4e49\u9f20\u6807\u4e8b\u4ef6\u89e6\u53d1\u7684\u8303\u56f4\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u6a21\u578b\u7ec4\uff0c\u5bf9\u7ed9\u5b9a\u7684\u6a21\u578b\u7ec4\u9f20\u6807\u4e8b\u4ef6\u624d\u751f\u6548 */\npublic setRaycasterObjects (objList: THREE.Object3D[]): void {\n  this.raycasterObjects = objList;\n}\n\nprivate getRaycasterIntersectObjects(): THREE.Intersection[] {\n  if (!this.raycasterObjects.length) return [];\n  this.raycaster.setFromCamera(this.mouse, this.camera);\n  return this.raycaster.intersectObjects(this.raycasterObjects, true);\n}\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"\u901a\u8fc7 setRaycasterObjects \u65b9\u6cd5\uff0c\u4f20\u9012\u4e00\u4e2a\u89e6\u53d1\u9f20\u6807\u4e8b\u4ef6\u7684\u6a21\u578b\u8303\u56f4\uff0c\u53ef\u4ee5\u907f\u514d\u5728\u6574\u4e2a\u573a\u666f\u4e2d\u90fd\u53bb\u89e6\u53d1\u9f20\u6807\u4e8b\u4ef6\u3002\u8fd9\u91cc\u4e5f\u53ef\u4ee5\u7528\u4e00\u4e2a Map \u53bb\u5b58\u4e0d\u540c\u6a21\u578b\u7684\u4e8b\u4ef6\uff0c\u5728\u53d6\u6d88\u8ba2\u9605\u65f6\u518d\u79fb\u9664\u3002"))),(0,a.kt)("p",null,"\u4f7f\u7528\u65b9\u5f0f\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"let viewer: Viewer;\nviewer = new Viewer('three');\n\nviewer.initRaycaster();\n\nviewer.emitter.on(Event.dblclick.raycaster, (list: THREE.Intersection[]) => {\n  onMouseClick(list);\n});\n\nviewer.emitter.on(Event.mousemove.raycaster, (list: THREE.Intersection[]) => {\n  onMouseMove(list);\n});\n")),(0,a.kt)("h2",{id:"2\u6a21\u578b\u52a0\u8f7d\u5668-modelloder-\u7c7b"},"2.\u6a21\u578b\u52a0\u8f7d\u5668 ModelLoder \u7c7b"),(0,a.kt)("p",null,"\u6a21\u578b\u7684\u52a0\u8f7d\u6211\u4eec\u9700\u8981\u7528\u7684threejs\u91cc\u9762\u7684\uff0c",(0,a.kt)("strong",{parentName:"p"},"GLTFLoader"),"\u3001",(0,a.kt)("strong",{parentName:"p"},"DRACOLoader")," \u8fd9\u4e24\u4e2a\u7c7b\u3002"),(0,a.kt)("p",null,"\u6a21\u578b\u52a0\u8f7d\u5668 ModelLoder \u521d\u59cb\u5316\u7684\u65f6\u5019\u9700\u8981\u628a Viewer \u7684\u5b9e\u4f8b\u4f20\u8fdb\u53bb\u3002"),(0,a.kt)("p",null,"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u9700\u8981\u628a draco \u4ece node_modules \u62f7\u8d1d\u5230\u9879\u76ee\u7684 ",(0,a.kt)("strong",{parentName:"p"},"public")," \u76ee\u5f55\u4e2d\u53bb\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"draco",src:n(3467).Z,title:"draco\u76ee\u5f55",width:"509",height:"627"})),(0,a.kt)("p",null,"\u5b9e\u73b0\u4ee3\u7801\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader';\nimport BaseModel from '../BaseModel';\nimport type Viewer from '../Viewer';\n\ntype LoadModelCallbackFn<T = any> = (arg: T) => any;\n\n/**\u6a21\u578b\u52a0\u8f7d\u5668 */\nexport default class ModelLoder {\n  protected viewer: Viewer;\n  private gltfLoader: GLTFLoader;\n  private dracoLoader: DRACOLoader;\n\n  constructor(viewer: Viewer, dracolPath: string = '/draco/') {\n    this.viewer = viewer;\n    this.gltfLoader = new GLTFLoader();\n    this.dracoLoader = new DRACOLoader();\n\n    // \u63d0\u4f9b\u4e00\u4e2aDracLoader\u5b9e\u4f8b\u6765\u89e3\u7801\u538b\u7f29\u7f51\u683c\u6570\u636e\n    // \u6ca1\u6709\u8fd9\u4e2a\u4f1a\u62a5\u9519 dracolPath \u9ed8\u8ba4\u653e\u5728public\u6587\u4ef6\u5939\u5f53\u4e2d\n    this.dracoLoader.setDecoderPath(dracolPath);\n    this.gltfLoader.setDRACOLoader(this.dracoLoader);\n  }\n\n  /**\u6a21\u578b\u52a0\u8f7d\u5230\u573a\u666f */\n  public loadModelToScene(url: string, callback: LoadModelCallbackFn<BaseModel>) {\n    this.loadModel(url, model => {\n      this.viewer.scene.add(model.object);\n      callback && callback(model);\n    });\n  }\n\n  private loadModel(url: string, callback: LoadModelCallbackFn<BaseModel>) {\n    this.gltfLoader.load(url, gltf => {\n      const baseModel = new BaseModel(gltf, this.viewer);\n      callback && callback(baseModel);\n    });\n  }\n}\n")),(0,a.kt)("h2",{id:"3\u6a21\u578b-basemodel-\u7c7b"},"3.\u6a21\u578b BaseModel \u7c7b"),(0,a.kt)("p",null,"\u8fd9\u91cc\u5bf9\u6a21\u578b\u5916\u9762\u5305\u4e86\u4e00\u5c42\uff0c\u505a\u4e86\u4e00\u4e9b\u989d\u5916\u7684\u529f\u80fd\uff0c\u5982\u6a21\u578b\u514b\u9686\u3001\u64ad\u653e\u52a8\u753b\u3001\u8bbe\u7f6e\u6a21\u578b\u7279\u6027\u3001\u989c\u8272\u3001\u6750\u8d28\u7b49\u65b9\u6cd5\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"/**\n* \u8bbe\u7f6e\u6a21\u578b\u52a8\u753b\n* @param i \u9009\u62e9\u6a21\u578b\u52a8\u753b\u8fdb\u884c\u64ad\u653e\n*/\npublic startAnima(i = 0) {\n  this.animaIndex = i;\n  if (!this.mixer) this.mixer = new THREE.AnimationMixer(this.object);\n  if (this.gltf.animations.length < 1) return;\n  this.mixer.clipAction(this.gltf.animations[i]).play();\n  // \u4f20\u5165\u53c2\u6570\u9700\u8981\u5c06\u51fd\u6570\u4e0e\u51fd\u6570\u53c2\u6570\u5206\u5f00\uff0c\u5728\u8fd0\u884c\u65f6\u586b\u5165\n  this.animaObject = {\n    fun: this.updateAnima,\n    content: this,\n  };\n  this.viewer.addAnimate(this.animaObject);\n}\n\nprivate updateAnima(e: any) {\n  e.mixer.update(e.clock.getDelta());\n}\n")),(0,a.kt)("p",null,"\u8fd8\u6709\u4e00\u4e9b\u5176\u4ed6\u65b9\u6cd5\u7684\u5b9e\u73b0\uff0c\u53ef\u4ee5\u770b\u4ed3\u5e93\u4ee3\u7801\u3002"),(0,a.kt)("h2",{id:"4\u5929\u7a7a\u76d2-skyboxs-\u7c7b"},"4.\u5929\u7a7a\u76d2 SkyBoxs \u7c7b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import * as THREE from 'three';\nimport type Viewer from '../Viewer';\nimport { Sky } from '../type';\n\n/** \u573a\u666f\u5929\u7a7a\u76d2*/\nexport default class SkyBoxs {\n  protected viewer: Viewer;\n  \n  constructor (viewer: Viewer) {\n    this.viewer = viewer;\n  }\n\n  /**\n   * \u6dfb\u52a0\u96fe\u6548\u679c\n   * @param color \u989c\u8272\n   */\n  public addFog (color = 0xa0a0a0, near = 500, far = 2000) {\n    this.viewer.scene.fog = new THREE.Fog(new THREE.Color(color), near, far);\n  }\n\n  /**\n   * \u79fb\u9664\u96fe\u6548\u679c\n   */\n  public removeFog () {\n    this.viewer.scene.fog = null;\n  }\n\n  /**\n   * \u6dfb\u52a0\u9ed8\u8ba4\u5929\u7a7a\u76d2\n   * @param skyType\n   */\n  public addSkybox (skyType: keyof typeof Sky = Sky.daytime) {\n    const path = `/skybox/${Sky[skyType]}/`; // \u8bbe\u7f6e\u8def\u5f84\n    const format = '.jpg'; // \u8bbe\u5b9a\u683c\u5f0f\n    this.setSkybox(path, format);\n  }\n\n  /**\n   * \u81ea\u5b9a\u4e49\u6dfb\u52a0\u5929\u7a7a\u76d2\n   * @param path \u5929\u7a7a\u76d2\u5730\u5740\n   * @param format \u56fe\u7247\u540e\u7f00\u540d\n   */\n  private setSkybox (path: string, format = '.jpg') {\n    const loaderbox = new THREE.CubeTextureLoader();\n    const cubeTexture = loaderbox.load([\n      path + 'posx' + format,\n      path + 'negx' + format,\n      path + 'posy' + format,\n      path + 'negy' + format,\n      path + 'posz' + format,\n      path + 'negz' + format,\n    ]);\n    // \u9700\u8981\u628a\u8272\u5f69\u7a7a\u95f4\u7f16\u7801\u6539\u4e00\u4e0b\n    cubeTexture.encoding = THREE.sRGBEncoding;\n    this.viewer.scene.background = cubeTexture;\n  }\n}\n")),(0,a.kt)("h2",{id:"\u63a8\u8350\u9879\u76ee"},"\u63a8\u8350\u9879\u76ee"),(0,a.kt)("p",null,"\u4ee5\u4e0a\u529f\u80fd\u7684\u5c01\u88c5\u4e3b\u8981\u53c2\u8003\u4e86\u4ee5\u4e0b\u51e0\u4e2a\u6bd4\u8f83\u4e0d\u9519\u7684\u9879\u76ee"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/alwxkxk/iot-visualization-examples"},"https://github.com/alwxkxk/iot-visualization-examples")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://gitee.com/303711888/threejs-park"},"https://gitee.com/303711888/threejs-park")),(0,a.kt)("p",null,"\u8fd8\u6709\u4e00\u4e2a\u7528 vue3 hooks\u6765\u5199\u7684"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/fengtianxi001/MF-TurbineMonitor"},"https://github.com/fengtianxi001/MF-TurbineMonitor")))}d.isMDXComponent=!0},3467:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/draco-5bb5de503ac7356ebb20076959428623.png"},3280:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/\u9879\u76ee\u622a\u56fe-c6fdd677ad041374c2df5005520a8525.gif"}}]);